<ul class="nav nav-tabs nav-stacked">
	<li id="cat_<%= p.id %>" class="<%= params[:id].to_i == p.id.to_i ? 'active' : '' %>">
	 	<span>
		 	<%= link_to '', pages_path(parent: p.id), remote: true, class: "toogle icon-chevron-right" if page_tree(p).present? %>

			<% if p.ptype == 'article' || p.ptype == 'blog' %>
				<%= link_to p.name, children_page_path(p), class: page_tree(p).present? ? '' : 'children' %>
			<% else %>
				<%= link_to p.name, edit_page_path(p), class: page_tree(p).present? ? '' : 'children' %>
			<% end %>			
		</span>
		<hr>
		<% if @tree_ids.present? && @tree_ids.include?(p.id) %>
			<% page_tree(p).each do |children| %>
				<%= render 'rows', p: children %>	
			<% end %> 

			<%= content_for :javascript do %>
			<script type="text/javascript">
				$(function(){
					$('#cat_<%= p.id %> span a.toogle').first().addClass('icon-chevron-down');
					$('#cat_<%= p.id %> span a.toogle').first().removeClass('icon-chevron-right');
				})
			</script>
			<% end %>
		<% end %>	
		
	</li>
</ul>
